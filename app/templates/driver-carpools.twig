{% extends "layout.twig" %}

{% block content %}
<div class="max-w-2xl mx-auto mt-8 bg-white p-6 rounded-lg shadow-md">
    <h2 class="text-2xl font-semibold text-center mb-4 text-green-800">Driver Carpools</h2>

    {% if carpools is empty %}
        <p class="text-gray-600 text-center">No carpools found.</p>
    {% else %}
        <ul class="space-y-6">
            {% for carpool in carpools %}
                <li class="border-b pb-4">
                    <p class="text-sm"><strong>From:</strong> {{ carpool.pickup_location }}</p>
                    <p class="text-sm"><strong>To:</strong> {{ carpool.dropoff_location }}</p>
                    <p class="text-sm"><strong>Departure:</strong> {{ carpool.departure_time|date("d M Y â€“ H:i") }}</p>
                    <p class="text-sm"><strong>Status:</strong> {{ carpool.status|capitalize }}</p>
                    <p class="text-sm"><strong>Occupied Seats:</strong> {{ carpool.occupied_seats }}/{{ carpool.total_seats }}</p>

                    {% set status = carpool.status|lower %}
                    {% if status == 'upcoming' %}
                        <form method="POST" action="/driver/carpools/{{ carpool.id }}/start" class="mt-2">
                            <button class="bg-yellow-500 hover:bg-yellow-600 text-white text-sm px-4 py-2 rounded 
                                 {% if carpool.occupied_seats == 0 %} opacity-50 cursor-not-allowed {% endif %}"
                                   {% if carpool.occupied_seats == 0 %} disabled {% endif %}>
                                      Start Carpool
                            </button>
                    {% elseif status == 'in progress' %}
                        <form method="POST" action="/driver/carpools/{{ carpool.id }}/complete" class="mt-2">
                            <button class="bg-green-600 hover:bg-green-700 text-white text-sm px-4 py-2 rounded">
                            
                                Complete Carpool
                            </button>
                        </form>
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
    {% endif %}
</div>
{% endblock %}
